2025-12-04 21:53:45,122 - INFO - Found BLAST database files for ../DB/ref_viruses_rep_genomes: ['../DB/ref_viruses_rep_genomes.nhr']
2025-12-04 21:53:45,125 - INFO - Found BLAST database files for ../DB/ref_prok_rep_genomes: ['../DB/ref_prok_rep_genomes.05.nhr', '../DB/ref_prok_rep_genomes.02.nhr', '../DB/ref_prok_rep_genomes.21.nhr', '../DB/ref_prok_rep_genomes.13.nhr', '../DB/ref_prok_rep_genomes.14.nhr', '../DB/ref_prok_rep_genomes.03.nhr', '../DB/ref_prok_rep_genomes.04.nhr', '../DB/ref_prok_rep_genomes.15.nhr', '../DB/ref_prok_rep_genomes.12.nhr', '../DB/ref_prok_rep_genomes.20.nhr', '../DB/ref_prok_rep_genomes.11.nhr', '../DB/ref_prok_rep_genomes.16.nhr', '../DB/ref_prok_rep_genomes.18.nhr', '../DB/ref_prok_rep_genomes.23.nhr', '../DB/ref_prok_rep_genomes.24.nhr', '../DB/ref_prok_rep_genomes.09.nhr', '../DB/ref_prok_rep_genomes.07.nhr', '../DB/ref_prok_rep_genomes.00.nhr', '../DB/ref_prok_rep_genomes.22.nhr', '../DB/ref_prok_rep_genomes.19.nhr', '../DB/ref_prok_rep_genomes.17.nhr', '../DB/ref_prok_rep_genomes.10.nhr', '../DB/ref_prok_rep_genomes.01.nhr', '../DB/ref_prok_rep_genomes.06.nhr', '../DB/ref_prok_rep_genomes.08.nhr']
2025-12-04 21:53:45,127 - INFO - Found BLAST database files for ../DB/ref_euk_rep_genomes: ['../DB/ref_euk_rep_genomes.021.nhr', '../DB/ref_euk_rep_genomes.105.nhr', '../DB/ref_euk_rep_genomes.102.nhr', '../DB/ref_euk_rep_genomes.026.nhr', '../DB/ref_euk_rep_genomes.085.nhr', '../DB/ref_euk_rep_genomes.054.nhr', '../DB/ref_euk_rep_genomes.028.nhr', '../DB/ref_euk_rep_genomes.082.nhr', '../DB/ref_euk_rep_genomes.053.nhr', '../DB/ref_euk_rep_genomes.142.nhr', '../DB/ref_euk_rep_genomes.066.nhr', '../DB/ref_euk_rep_genomes.061.nhr', '../DB/ref_euk_rep_genomes.139.nhr', '../DB/ref_euk_rep_genomes.145.nhr', '../DB/ref_euk_rep_genomes.137.nhr', '../DB/ref_euk_rep_genomes.013.nhr', '../DB/ref_euk_rep_genomes.014.nhr', '../DB/ref_euk_rep_genomes.068.nhr', '../DB/ref_euk_rep_genomes.130.nhr', '../DB/ref_euk_rep_genomes.005.nhr', '../DB/ref_euk_rep_genomes.121.nhr', '../DB/ref_euk_rep_genomes.079.nhr', '../DB/ref_euk_rep_genomes.126.nhr', '../DB/ref_euk_rep_genomes.002.nhr', '../DB/ref_euk_rep_genomes.128.nhr', '../DB/ref_euk_rep_genomes.070.nhr', '../DB/ref_euk_rep_genomes.154.nhr', '../DB/ref_euk_rep_genomes.153.nhr', '../DB/ref_euk_rep_genomes.077.nhr', '../DB/ref_euk_rep_genomes.042.nhr', '../DB/ref_euk_rep_genomes.093.nhr', '../DB/ref_euk_rep_genomes.045.nhr', '../DB/ref_euk_rep_genomes.094.nhr', '../DB/ref_euk_rep_genomes.161.nhr', '../DB/ref_euk_rep_genomes.039.nhr', '../DB/ref_euk_rep_genomes.113.nhr', '../DB/ref_euk_rep_genomes.037.nhr', '../DB/ref_euk_rep_genomes.030.nhr', '../DB/ref_euk_rep_genomes.114.nhr', '../DB/ref_euk_rep_genomes.015.nhr', '../DB/ref_euk_rep_genomes.069.nhr', '../DB/ref_euk_rep_genomes.131.nhr', '../DB/ref_euk_rep_genomes.136.nhr', '../DB/ref_euk_rep_genomes.012.nhr', '../DB/ref_euk_rep_genomes.060.nhr', '../DB/ref_euk_rep_genomes.138.nhr', '../DB/ref_euk_rep_genomes.144.nhr', '../DB/ref_euk_rep_genomes.143.nhr', '../DB/ref_euk_rep_genomes.067.nhr', '../DB/ref_euk_rep_genomes.083.nhr', '../DB/ref_euk_rep_genomes.052.nhr', '../DB/ref_euk_rep_genomes.084.nhr', '../DB/ref_euk_rep_genomes.055.nhr', '../DB/ref_euk_rep_genomes.029.nhr', '../DB/ref_euk_rep_genomes.103.nhr', '../DB/ref_euk_rep_genomes.027.nhr', '../DB/ref_euk_rep_genomes.020.nhr', '../DB/ref_euk_rep_genomes.104.nhr', '../DB/ref_euk_rep_genomes.031.nhr', '../DB/ref_euk_rep_genomes.115.nhr', '../DB/ref_euk_rep_genomes.112.nhr', '../DB/ref_euk_rep_genomes.036.nhr', '../DB/ref_euk_rep_genomes.044.nhr', '../DB/ref_euk_rep_genomes.095.nhr', '../DB/ref_euk_rep_genomes.160.nhr', '../DB/ref_euk_rep_genomes.038.nhr', '../DB/ref_euk_rep_genomes.043.nhr', '../DB/ref_euk_rep_genomes.092.nhr', '../DB/ref_euk_rep_genomes.152.nhr', '../DB/ref_euk_rep_genomes.076.nhr', '../DB/ref_euk_rep_genomes.129.nhr', '../DB/ref_euk_rep_genomes.071.nhr', '../DB/ref_euk_rep_genomes.155.nhr', '../DB/ref_euk_rep_genomes.127.nhr', '../DB/ref_euk_rep_genomes.003.nhr', '../DB/ref_euk_rep_genomes.004.nhr', '../DB/ref_euk_rep_genomes.120.nhr', '../DB/ref_euk_rep_genomes.078.nhr', '../DB/ref_euk_rep_genomes.111.nhr', '../DB/ref_euk_rep_genomes.049.nhr', '../DB/ref_euk_rep_genomes.098.nhr', '../DB/ref_euk_rep_genomes.035.nhr', '../DB/ref_euk_rep_genomes.032.nhr', '../DB/ref_euk_rep_genomes.116.nhr', '../DB/ref_euk_rep_genomes.118.nhr', '../DB/ref_euk_rep_genomes.040.nhr', '../DB/ref_euk_rep_genomes.091.nhr', '../DB/ref_euk_rep_genomes.047.nhr', '../DB/ref_euk_rep_genomes.096.nhr', '../DB/ref_euk_rep_genomes.072.nhr', '../DB/ref_euk_rep_genomes.156.nhr', '../DB/ref_euk_rep_genomes.151.nhr', '../DB/ref_euk_rep_genomes.009.nhr', '../DB/ref_euk_rep_genomes.075.nhr', '../DB/ref_euk_rep_genomes.007.nhr', '../DB/ref_euk_rep_genomes.123.nhr', '../DB/ref_euk_rep_genomes.124.nhr', '../DB/ref_euk_rep_genomes.158.nhr', '../DB/ref_euk_rep_genomes.000.nhr', '../DB/ref_euk_rep_genomes.135.nhr', '../DB/ref_euk_rep_genomes.011.nhr', '../DB/ref_euk_rep_genomes.149.nhr', '../DB/ref_euk_rep_genomes.016.nhr', '../DB/ref_euk_rep_genomes.132.nhr', '../DB/ref_euk_rep_genomes.018.nhr', '../DB/ref_euk_rep_genomes.140.nhr', '../DB/ref_euk_rep_genomes.064.nhr', '../DB/ref_euk_rep_genomes.063.nhr', '../DB/ref_euk_rep_genomes.147.nhr', '../DB/ref_euk_rep_genomes.087.nhr', '../DB/ref_euk_rep_genomes.056.nhr', '../DB/ref_euk_rep_genomes.080.nhr', '../DB/ref_euk_rep_genomes.051.nhr', '../DB/ref_euk_rep_genomes.109.nhr', '../DB/ref_euk_rep_genomes.023.nhr', '../DB/ref_euk_rep_genomes.107.nhr', '../DB/ref_euk_rep_genomes.089.nhr', '../DB/ref_euk_rep_genomes.058.nhr', '../DB/ref_euk_rep_genomes.100.nhr', '../DB/ref_euk_rep_genomes.024.nhr', '../DB/ref_euk_rep_genomes.125.nhr', '../DB/ref_euk_rep_genomes.159.nhr', '../DB/ref_euk_rep_genomes.001.nhr', '../DB/ref_euk_rep_genomes.006.nhr', '../DB/ref_euk_rep_genomes.122.nhr', '../DB/ref_euk_rep_genomes.150.nhr', '../DB/ref_euk_rep_genomes.008.nhr', '../DB/ref_euk_rep_genomes.074.nhr', '../DB/ref_euk_rep_genomes.073.nhr', '../DB/ref_euk_rep_genomes.157.nhr', '../DB/ref_euk_rep_genomes.046.nhr', '../DB/ref_euk_rep_genomes.097.nhr', '../DB/ref_euk_rep_genomes.119.nhr', '../DB/ref_euk_rep_genomes.041.nhr', '../DB/ref_euk_rep_genomes.090.nhr', '../DB/ref_euk_rep_genomes.033.nhr', '../DB/ref_euk_rep_genomes.117.nhr', '../DB/ref_euk_rep_genomes.110.nhr', '../DB/ref_euk_rep_genomes.048.nhr', '../DB/ref_euk_rep_genomes.099.nhr', '../DB/ref_euk_rep_genomes.034.nhr', '../DB/ref_euk_rep_genomes.088.nhr', '../DB/ref_euk_rep_genomes.059.nhr', '../DB/ref_euk_rep_genomes.101.nhr', '../DB/ref_euk_rep_genomes.025.nhr', '../DB/ref_euk_rep_genomes.022.nhr', '../DB/ref_euk_rep_genomes.106.nhr', '../DB/ref_euk_rep_genomes.081.nhr', '../DB/ref_euk_rep_genomes.050.nhr', '../DB/ref_euk_rep_genomes.108.nhr', '../DB/ref_euk_rep_genomes.086.nhr', '../DB/ref_euk_rep_genomes.057.nhr', '../DB/ref_euk_rep_genomes.062.nhr', '../DB/ref_euk_rep_genomes.146.nhr', '../DB/ref_euk_rep_genomes.019.nhr', '../DB/ref_euk_rep_genomes.141.nhr', '../DB/ref_euk_rep_genomes.065.nhr', '../DB/ref_euk_rep_genomes.017.nhr', '../DB/ref_euk_rep_genomes.133.nhr', '../DB/ref_euk_rep_genomes.134.nhr', '../DB/ref_euk_rep_genomes.010.nhr', '../DB/ref_euk_rep_genomes.148.nhr']
2025-12-04 21:53:50,971 - INFO - blastn is installed and accessible
2025-12-04 21:53:50,971 - INFO - Initialized PathogenSimilarityAnalyzer for /work/ia29ipap-PRJs/PRJS/APD/Data/PREPARETiD_DOMESTICANIMALS_SEPTEMEBER2025_UGANDA/barcode45 (platform: nanopore, strictness: Fast, file_exts: ['fastq.gz'])
2025-12-04 21:53:50,981 - INFO - Loaded BLAST parameters from strictness_setting.yaml
2025-12-04 21:53:50,981 - INFO - Starting analysis for /work/ia29ipap-PRJs/PRJS/APD/Data/PREPARETiD_DOMESTICANIMALS_SEPTEMEBER2025_UGANDA/barcode45 (platform: nanopore, strictness: Fast)
2025-12-04 21:53:50,981 - INFO - Preprocessing reads...
2025-12-04 21:53:50,981 - INFO - Preprocessing reads for nanopore
2025-12-04 21:53:50,982 - INFO - Nanopore preprocessing: Consider running Porechop for adapter trimming
2025-12-04 21:53:50,982 - INFO - Loading reads...
2025-12-04 21:53:50,983 - INFO - Found 28 files
Processing files:   0%|          | 0/28 [00:00<?, ?it/s]Processing files: 100%|██████████| 28/28 [00:00<00:00, 379.68it/s]
2025-12-04 21:53:51,062 - INFO - Processed 456 reads → /tmp/tmp6_81sr08/all_reads.fasta
2025-12-04 21:53:51,062 - INFO - Loaded qualities for 456 reads.
2025-12-04 21:53:51,062 - INFO - Running BLAST analysis with nanopore and Fast parameters...
2025-12-04 21:53:51,063 - INFO - Running BLAST command against ../DB/ref_viruses_rep_genomes with 64 threads: blastn -db ../DB/ref_viruses_rep_genomes -query /tmp/tmp6_81sr08/all_reads.fasta -outfmt 5 -out /tmp/tmp6_81sr08/all_reads_ref_viruses_rep_genomes.xml -evalue 100.0 -word_size 20 -perc_identity 55 -max_target_seqs 8 -qcov_hsp_perc 25 -gapopen 12 -gapextend 6 -num_threads 64 -task megablast
2025-12-04 21:53:53,901 - INFO - BLAST completed against ../DB/ref_viruses_rep_genomes
Processing BLAST records (ref_viruses_rep_genomes): 0it [00:00, ?it/s]Processing BLAST records (ref_viruses_rep_genomes): 456it [00:00, 4721.40it/s]
2025-12-04 21:53:53,999 - INFO - Running BLAST command against ../DB/ref_prok_rep_genomes with 64 threads: blastn -db ../DB/ref_prok_rep_genomes -query /tmp/tmp6_81sr08/all_reads.fasta -outfmt 5 -out /tmp/tmp6_81sr08/all_reads_ref_prok_rep_genomes.xml -evalue 100.0 -word_size 20 -perc_identity 55 -max_target_seqs 8 -qcov_hsp_perc 25 -gapopen 12 -gapextend 6 -num_threads 64 -task megablast
2025-12-04 21:56:58,661 - INFO - BLAST completed against ../DB/ref_prok_rep_genomes
Processing BLAST records (ref_prok_rep_genomes): 0it [00:00, ?it/s]Processing BLAST records (ref_prok_rep_genomes): 163it [00:00, 1613.19it/s]Processing BLAST records (ref_prok_rep_genomes): 350it [00:00, 1755.12it/s]Processing BLAST records (ref_prok_rep_genomes): 456it [00:00, 1768.21it/s]
2025-12-04 21:56:58,922 - INFO - Running BLAST command against ../DB/ref_euk_rep_genomes with 64 threads: blastn -db ../DB/ref_euk_rep_genomes -query /tmp/tmp6_81sr08/all_reads.fasta -outfmt 5 -out /tmp/tmp6_81sr08/all_reads_ref_euk_rep_genomes.xml -evalue 100.0 -word_size 20 -perc_identity 55 -max_target_seqs 8 -qcov_hsp_perc 25 -gapopen 12 -gapextend 6 -num_threads 64 -task megablast
2025-12-04 22:34:18,118 - INFO - BLAST completed against ../DB/ref_euk_rep_genomes
Processing BLAST records (ref_euk_rep_genomes): 0it [00:00, ?it/s]Processing BLAST records (ref_euk_rep_genomes): 138it [00:00, 1370.29it/s]Processing BLAST records (ref_euk_rep_genomes): 312it [00:00, 1586.33it/s]Processing BLAST records (ref_euk_rep_genomes): 456it [00:00, 1632.87it/s]
2025-12-04 22:34:18,449 - INFO - Found 5031 pathogen hits.
2025-12-04 22:34:18,452 - INFO - Fetching taxonomy for 96 unique accessions with rate limit.
Fetching taxonomy:   0%|          | 0/32 [00:00<?, ?it/s]Fetching taxonomy:   3%|▎         | 1/32 [00:00<00:16,  1.86it/s]Fetching taxonomy:   6%|▋         | 2/32 [00:01<00:15,  1.94it/s]Fetching taxonomy:   9%|▉         | 3/32 [00:01<00:14,  1.96it/s]Fetching taxonomy:  12%|█▎        | 4/32 [00:02<00:14,  1.98it/s]Fetching taxonomy:  16%|█▌        | 5/32 [00:02<00:13,  1.98it/s]Fetching taxonomy:  19%|█▉        | 6/32 [00:03<00:13,  1.99it/s]Fetching taxonomy:  22%|██▏       | 7/32 [00:03<00:12,  1.99it/s]Fetching taxonomy:  25%|██▌       | 8/32 [00:04<00:12,  1.99it/s]Fetching taxonomy:  28%|██▊       | 9/32 [00:04<00:11,  1.99it/s]Fetching taxonomy:  31%|███▏      | 10/32 [00:05<00:11,  2.00it/s]Fetching taxonomy:  34%|███▍      | 11/32 [00:05<00:10,  2.00it/s]Fetching taxonomy:  38%|███▊      | 12/32 [00:06<00:10,  2.00it/s]Fetching taxonomy:  41%|████      | 13/32 [00:06<00:09,  2.00it/s]Fetching taxonomy:  44%|████▍     | 14/32 [00:07<00:09,  2.00it/s]Fetching taxonomy:  47%|████▋     | 15/32 [00:07<00:08,  2.00it/s]Fetching taxonomy:  50%|█████     | 16/32 [00:08<00:08,  2.00it/s]Fetching taxonomy:  53%|█████▎    | 17/32 [00:08<00:07,  2.00it/s]Fetching taxonomy:  56%|█████▋    | 18/32 [00:09<00:07,  2.00it/s]Fetching taxonomy:  59%|█████▉    | 19/32 [00:09<00:06,  2.00it/s]Fetching taxonomy:  62%|██████▎   | 20/32 [00:10<00:06,  2.00it/s]Fetching taxonomy:  66%|██████▌   | 21/32 [00:10<00:05,  2.00it/s]Fetching taxonomy:  69%|██████▉   | 22/32 [00:11<00:05,  2.00it/s]Fetching taxonomy:  72%|███████▏  | 23/32 [00:11<00:04,  2.00it/s]Fetching taxonomy:  75%|███████▌  | 24/32 [00:12<00:04,  2.00it/s]Fetching taxonomy:  78%|███████▊  | 25/32 [00:12<00:03,  2.00it/s]Fetching taxonomy:  81%|████████▏ | 26/32 [00:13<00:03,  2.00it/s]Fetching taxonomy:  84%|████████▍ | 27/32 [00:13<00:02,  2.00it/s]Fetching taxonomy:  88%|████████▊ | 28/32 [00:14<00:02,  2.00it/s]Fetching taxonomy:  91%|█████████ | 29/32 [00:14<00:01,  2.00it/s]Fetching taxonomy:  94%|█████████▍| 30/32 [00:15<00:01,  2.00it/s]Fetching taxonomy:  97%|█████████▋| 31/32 [00:15<00:00,  2.00it/s]Fetching taxonomy: 100%|██████████| 32/32 [00:16<00:00,  2.00it/s]Fetching taxonomy: 100%|██████████| 32/32 [00:16<00:00,  1.99it/s]
2025-12-04 22:34:45,575 - WARNING - Corrupted cache file /tmp/tmp6_81sr08/taxonomy_cache.json, starting new cache.
2025-12-04 22:34:47,367 - WARNING - HTTP 429 for NW_023666045, retrying after 1 seconds...
2025-12-04 22:34:51,889 - WARNING - HTTP 429 for NW_026099245, retrying after 1 seconds...
Applying taxonomy and filtering:   0%|          | 0/5031 [00:00<?, ?it/s]Applying taxonomy and filtering: 100%|██████████| 5031/5031 [00:00<00:00, 522005.33it/s]
2025-12-04 22:35:05,605 - INFO - Filtered and sorted 2967 hits with similarity > 0% and valid pathogen type (Virus, Bacteria, Parasite)
2025-12-04 22:35:05,606 - INFO - Creating report directory: /work/ia29ipap-PRJs/PRJS/APD/Data/PREPARETiD_DOMESTICANIMALS_SEPTEMEBER2025_UGANDA/report
2025-12-04 22:35:06,852 - INFO - Report saved → /work/ia29ipap-PRJs/PRJS/APD/Data/PREPARETiD_DOMESTICANIMALS_SEPTEMEBER2025_UGANDA/report/barcode45_sim_report.xlsx
2025-12-04 22:35:06,854 - INFO - Cleaned up temporary directory: /tmp/tmp6_81sr08
2025-12-04 22:35:07,921 - INFO - Loaded cache from pathogen_cache.json with 7751 entries
2025-12-04 22:35:07,923 - INFO - Initialized PathogenClassifier for /work/ia29ipap-PRJs/PRJS/APD/Data/PREPARETiD_DOMESTICANIMALS_SEPTEMEBER2025_UGANDA/report/barcode45_sim_report.xlsx
2025-12-04 22:35:08,174 - INFO - Read 'Distilled Report' sheet with 30 rows
2025-12-04 22:35:08,175 - INFO - Classifying 30 unique binomial names
  0%|          | 0/30 [00:00<?, ?it/s]2025-12-04 22:35:08,681 - INFO - Saved cache to pathogen_cache.json
2025-12-04 22:35:08,681 - INFO - Classified Neorhizobium tomejilense as non-pathogenic (PubMed count: 0)
 33%|███▎      | 10/30 [00:00<00:00, 20.08it/s]2025-12-04 22:35:09,112 - INFO - Saved cache to pathogen_cache.json
2025-12-04 22:35:09,113 - INFO - Classified Corynebacterium crudilactis as non-pathogenic (PubMed count: 0)
2025-12-04 22:35:09,542 - INFO - Saved cache to pathogen_cache.json
2025-12-04 22:35:09,542 - INFO - Classified Pseudomonas palmensis as non-pathogenic (PubMed count: 0)
 43%|████▎     | 13/30 [00:01<00:02,  8.26it/s]2025-12-04 22:35:09,971 - INFO - Saved cache to pathogen_cache.json
2025-12-04 22:35:09,971 - INFO - Classified Shewanella ulleungensis as non-pathogenic (PubMed count: 0)
 87%|████████▋ | 26/30 [00:01<00:00, 15.67it/s]2025-12-04 22:35:10,406 - INFO - Saved cache to pathogen_cache.json
2025-12-04 22:35:10,406 - INFO - Classified Echinicola vietnamensis DSM 17526 as non-pathogenic (PubMed count: 0)
 93%|█████████▎| 28/30 [00:02<00:00, 12.05it/s]2025-12-04 22:35:10,832 - INFO - Saved cache to pathogen_cache.json
2025-12-04 22:35:10,832 - INFO - Classified Paraburkholderia caffeinitolerans as non-pathogenic (PubMed count: 0)
100%|██████████| 30/30 [00:02<00:00,  9.74it/s]100%|██████████| 30/30 [00:02<00:00, 11.32it/s]
Classifying binomial names:   0%|          | 0/30 [00:00<?, ?it/s]Classifying binomial names: 100%|██████████| 30/30 [00:00<00:00, 81920.00it/s]
2025-12-04 22:35:10,837 - INFO - Classified 0 pathogenic rows and 30 non-pathogenic rows
2025-12-04 22:35:12,091 - INFO - Appended sheets 'Pathogenic' and 'Non-Pathogenic' to /work/ia29ipap-PRJs/PRJS/APD/Data/PREPARETiD_DOMESTICANIMALS_SEPTEMEBER2025_UGANDA/report/barcode45_sim_report.xlsx
Analyzing microbes for pathogenicity:   0%|          | 0/30 [00:00<?, ?it/s]Analyzing microbes for pathogenicity: 100%|██████████| 30/30 [00:00<00:00, 3155.91it/s]
Updated Excel file with new sheet 'Distilled Report with Pathogenicity' saved to /work/ia29ipap-PRJs/PRJS/APD/Data/PREPARETiD_DOMESTICANIMALS_SEPTEMEBER2025_UGANDA/report/barcode45_sim_report.xlsx
Finished processing /work/ia29ipap-PRJs/PRJS/APD/Data/PREPARETiD_DOMESTICANIMALS_SEPTEMEBER2025_UGANDA/barcode45
